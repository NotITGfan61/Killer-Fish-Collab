--code goes here here :)

videogameflip = {
	{4.500,0,1},
	{5.500,3,1},
	{5.750,0,1},
	{6.500,3,1},
	{7.250,0,1},
	{7.750,3,1},
	{8.500,0,1},
	{9.500,3,1},
	{10.250,0,1},
	{11.500,3,1},
	{12.500,0,1},
	{13.500,3,1},
	{13.750,0,1},
	{14.500,3,1},
	{15.250,0,1},
	{15.750,3,1},
	{16.500,0,1},
	{17.500,3,1},
	{18.250,0,1},
	{19.500,3,1},
	{20.500,0,1},
	{21.500,3,1},
	{21.750,0,1},
	{22.500,3,1},
	{23.250,0,1},
	{23.750,3,1},
	{24.500,0,1},
	{25.500,3,1},
	{26.250,0,1},
	{27.500,3,1},
	{28.500,0,1},
	{29.500,3,1},
	{29.750,0,1},
	{30.500,3,1},
	{31.250,0,1},
	{31.750,3,1},
	{32.500,0,1},
	{33.500,3,1},
	{34.250,0,1},
	{35.500,3,1},
	{36.500,0,1},
	{37.500,3,1},
	{37.750,0,1},
	{38.500,3,1},
	{39.250,0,1},
	{39.750,3,1},
	{40.500,0,1},
	{41.500,3,1},
	{42.250,0,1},
	{43.500,3,1},
	{44.500,0,1},
	{45.500,3,1},
	{45.750,0,1},
	{46.500,3,1},
	{47.250,0,1},
	{47.750,3,1},
	{48.500,0,1},
	{49.500,3,1},
	{50.250,0,1},
	{51.500,3,1},
	{636.500,0,1},
	{637.500,3,1},
	{637.750,0,1},
	{638.500,3,1},
	{639.250,0,1},
	{639.750,3,1},
	{640.500,0,1},
	{641.500,3,1},
	{642.250,0,1},
	{643.500,3,1},
	{644.500,0,1},
	{645.500,3,1},
	{645.750,0,1},
	{646.500,3,1},
	{647.250,0,1},
	{647.750,3,1},
	{648.500,0,1},
	{649.500,3,1},
	{650.250,0,1},
	{651.500,3,1},
	{652.500,0,1},
	{653.500,3,1},
	{653.750,0,1},
	{654.500,3,1},
	{655.250,0,1},
	{655.750,3,1},
	{656.500,0,1},
	{657.500,3,1},
	{658.250,0,1},
	{659.500,3,1},
	{660.500,0,1},
	{661.500,3,1},
	{661.750,0,1},
	{662.500,3,1},
	{663.250,0,1},
	{663.750,3,1},
	{664.500,0,1},
	{665.500,3,1},
	{666.250,0,1},
	{667.500,3,1},
	{668.500,0,1},
	{669.500,3,1},
	{669.750,0,1},
	{670.500,3,1},
	{671.250,0,1},
	{671.750,3,1},
	{672.500,0,1},
	{673.500,3,1},
	{674.250,0,1},
	{675.500,3,1},
	{676.500,0,1},
	{677.500,3,1},
	{677.750,0,1},
	{678.500,3,1},
	{679.250,0,1},
	{679.750,3,1},
	{680.500,0,1},
	{681.500,3,1},
	{682.250,0,1},
	{683.500,3,1},
	{684.500,0,1},
	{685.500,3,1},
	{685.750,0,1},
	{686.500,3,1},
	{687.250,0,1},
	{687.750,3,1},
	{688.500,0,1},
	{689.500,3,1},
	{690.250,0,1},
	{691.500,3,1},
}

videogameflip2 = {
	{41.000,0,1},
	{41.750,3,1},
	{42.500,0,1},
	{43.000,3,1},
	{43.500,0,1},
	{44.000,3,1},
	{49.000,0,1},
	{49.750,3,1},
	{50.500,0,1},
	{50.750,3,1},
	{51.000,0,1},
	{51.250,3,1},
	{51.500,0,1},
	{52.000,3,1},
}

introspin = {
	{52.000,0,1},
	{53.000,3,1},
	{53.750,0,1},
	{54.500,3,1},
	{55.000,0,1},
	{55.500,3,1},
	{56.000,0,1},
	{56.333,3,1},
	{56.667,0,1},
	{57.000,3,1},
	{57.250,0,1},
	{57.500,3,1},
	{57.750,0,1},
	{58.000,3,1},
	{58.167,0,1},
	{58.333,3,1},
	{58.500,0,1},
	{58.667,3,1},
	{58.833,0,1},
	{59.000,3,1},
	{59.125,0,1},
	{59.250,3,1},
	{59.375,0,1},
	{59.500,3,1},
	{59.625,0,1},
	{59.750,3,1},
	{59.875,0,1},
	{60.000,3,1},
}

fishspeech = {
	{685.500,0,2,length=1.000},
	{686.500,3,2,length=1.167},
	{687.667,0,2,length=0.333},
	{688.000,3,2,length=0.750},
	{688.750,0,2,length=1.000},
	{689.750,3,2,length=1.250},
	{692.500,0,2,length=1.000},
	{693.500,3,2,length=0.500},
	{694.000,0,2,length=1.000},
	{695.000,3,2,length=1.000},
	{696.000,0,2,length=1.000},
	{697.000,3,2,length=2.000},
}

function swap2(t)
	t[1] = t[1] - (t[2]*0.5)
	return swap(t)
end

local function womp(beat)
	for i = beat,beat+4 do
		kick(i,0.5,1.5,'Expo','Expo',0,200,'drunkz')
		kick(i,0.5,1,'Expo','Expo',0,75,'drunk')
		kick(i,0.5,1,'Expo','Expo',0,-4000,'tinyz')
		kick(i,0.5,2,'Expo','Expo',0,-100,'cooltiny')
		kick(i,0.5,1,'Expo','Elastic',100,125,'zoomy')
		kick(i,0.5,1.5,'Expo','Expo',0,-50,'flip')
		kick(i,0.5,1.5,'Expo','Expo',0,25,'brake')
	end
end

----------------- Intro Setup --------------------------------------
AfSetup(itgaf,90)
set{0,-50,'squarezperiod',100,'middle',0,'zoom',10000,'drunkzspeed',10000,'drunkspeed',1000,'drunkspacing'}

func {0, function()
	itg:zoom(0)
end}

func_ease {3.5, 1, ExpoS, 0, 1, 'itg:zoom'}
ease2{4,1,ExpoS,100,'zoom'}


local f = 1
for i = 4,51 do
	kick(i,0.25,0.5,'Expo','Expo',0,300*f,'squarez')
	kick(i,0.25,0.5,'Expo','Expo',0,-100,'tiny')
	func_ease {i-0.25, 0.25, ExpoI, 0, 25, 'itg:z'}
	func_ease {i, 0.5, ExpoO, 25, 0, 'itg:z'}
f = f * -1
end

local f = 1
for i=1,table.getn(videogameflip) do
	local beat = videogameflip[i][1]
	local col = videogameflip[i][2]
	
	if col == 0 then
		ease2{beat,0.75,WiggleS,100,'movex1',-100,'movex2'}
	elseif col == 3 then
		ease2{beat,0.75,WiggleS,0,'movex1',0,'movex2'}
	end
	
f = f*-1
end

local f = 1
for i=1,table.getn(videogameflip2) do
	local beat = videogameflip2[i][1]
	local col = videogameflip2[i][2]
	
	if col == 0 then
		ease2{beat,0.75,WiggleS,300,'movex0',-300,'movex3'}
	elseif col == 3 then
		ease2{beat,0.75,WiggleS,0,'movex0',0,'movex3'}
	end
	
f = f*-1
end

local f = 1
for i=1,table.getn(introspin) do
	local beat = introspin[i][1]
	ease{beat,1,flip(ExpoO),-300,'cooltiny'}
	ease{beat,1,flip(ExpoO),50,'drunk'}
	func_ease {beat, 2, popElastic:params(1,25), 3, 'itg:x'}
	func_ease {beat, 1, ExpoO, 0, -25, 'itg:z2'}
	
f = f*-1
end

womp(36)
womp(44)


ease{36,24,QuartI,0,'zoom',200,'zoomz',45,'coolrotationx'}
func_ease{36, 24, QuartI, 1, 0, 'itg:zoom2'}

add{52,6,CubicI,360*4,'coolrotationy'}
add{58,2,linear,360*6,'coolrotationy'}
add{60,4,CubicO,360*3,'coolrotationy'}
set{64,0,'coolrotationy'}



func {60, function()
	itgaf:hidden(1)
end}




---------------------- FIGHT ME OR DIE ------------------------------
AfSetup(textaf,90)

textobj:GetShader():uniformTexture('matcapTexture',texttex:GetTexture())

--modelzoom(textobj,1.25)

textobj:y(sh/8)

perframe{192,6,function(beat,poptions)
	local sin = math.sin(beat*math.pi*0.25)
	local cos = math.cos(beat*math.pi*0.25)
	textobj:rotationx(-5*sin)
end}

func {192, function()
	textaf:hidden(0)
end}


func {197, function()
	textaf:hidden(1)
end}


func_ease {192, 3, WiggleO, 0, 1.25, function(p)
	modelzoom(textobj,p)
end}

func_ease {196-1.5, 3, SmoothS, 0, 360, 'textobj:z'}

---------------------- Outro Setup --------------------------------
AfSetup(itgfishaf,90)

modelzoom(itgfish,0)
itgfish:rotationy(-90)

definemod{'itgfishamp', 'itgfishperiod', 'itgfishspeed', function(amp, per, spd)
	itgfish:GetShader():uniform1f('amp', amp)
	itgfish:GetShader():uniform1f('per', per)
	itgfish:GetShader():uniform1f('spd', spd)
end}

definemod{'itgfishrotx', 'itgfishroty', 'itgfishrotz', 'itgfishrotz2', function(rx, ry, rz,rz2)
	itgfishaf2:rotationx(rx):rotationy(ry):rotationz(rz+rz2)
end}

set{668,2,'itgfishamp',30,'itgfishperiod',0.5,'itgfishspeed'}


definemod {'itgz2', function(p)
    itg:z2(p)
end}

func {636, function()
	above.frame:hidden(1)
	itgaf:hidden(0)
	itg:zoom(1)
	itg:zoom2(1)
	itg:z2(0)
end}

ease{636,16,linear,100,'hidden'}

local f = 1
for i = 636,660,8 do
	ease{i,4,SineO,0.5,'xmod'}
	ease{i+4,4,SineI,2,'xmod'}
f = f * -1
end

local f = 1
for i = 636,691 do
	kick(i,0.25,0.5,'Expo','Expo',0,300*f,'squarez')
	kick(i,0.25,0.5,'Expo','Expo',0,-100,'tiny')
	func_ease {i-0.25, 0.25, ExpoI, 0, 25, 'itg:z'}
	func_ease {i, 0.5, ExpoO, 25, 0, 'itg:z'}
f = f * -1
end

func_ease{636, 32, linear, 100, 0, 'itg:z2'}
ease{636,32,flip(linear),100,'z'}

add2{668,4,inverseExpo,-500,'z'}

set{668,0,'hidden',10000,'drunkspeed'}


ease{668,692-668,linear,100,'brake',0.5,'xmod',314/6,'dizzy'}

ease{668,692-668,ExpoI,-200,'itgz2'}
add2{692,2,WiggleS,-400,'itgz2',200,'tipsy',500,'longholds'}


ease{696,4,WiggleI,200,'itgz2',5000,'z'}

kick(692,0.5,4,'Expo','Elastic',100,200,'zoomx')

ease{684,700-684,ExpoI,-1000,'tinyy',500,'zoomz',-90,'rotationx'}
ease{692,12,CubicS,360*7,'coolrotationy'}

local f = 1
for i=1,table.getn(fishspeech) do
	local beat = fishspeech[i][1]
	local len = fishspeech[i].length
	ease{beat,len,bounce,-5,'itgfishrotx'}
	ease{beat,len,bounce,-5*f,'itgfishroty'}
f = f*-1
end

func {668, function()
	itgfishaf:hidden(0)
end}

add{697,4,SineS,360*3,'itgfishrotz2'}

func_ease{691, 2, WiggleS, 0, -200, 'itgfishaf2:z'}

func_ease {685.5-1, 2, ExpoS, 0, 8, function(p)
	modelzoom(itgfish,p)
end}

func_ease{696, 4, WiggleI, -200, 400, 'itgfishaf2:z'}


---------------------- Fin Setup ---------------------------------
AfSetup(endingaf,90)
finbg:zoomto(sw/1.5,sh/1.5)

ModelSetup(endfish,5)
endfish:y(sh/16)
endfish:rotationx(-25)
endfish:rotationz(-25)

endquad:zoomto(sw,sh)
endquad:diffuse(0,0,0,0)

endtext:zoomto(sw/2,sh/2)
endtext:y(-sh/4)

endfish:hidden(1)
endquad:hidden(1)
endtext:hidden(1)
finbg:hidden(1)

set{700,100,'hide'}

func {700, function()
	itgaf:hidden(1)
	itgfishaf:hidden(1)
	endingaf:hidden(0)
end}

func {701.5, function()
	endfish:hidden(0)
	endquad:hidden(0)
	endtext:hidden(0)
	finbg:hidden(0)
end}


func_ease {701.5, 16, outExpo, 360, 0, 'endingaf:z'}
func_ease {701.5, 16, outExpo, 1, 0, 'endquad:diffusealpha'}

func_ease {717-1, 2, ExpoS, 0, 1, 'endquad:diffusealpha'}